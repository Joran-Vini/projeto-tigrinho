{% extends "layout.html" %}

{% block title %}
   Ca√ßa-N√≠queis
{% endblock %}

{% block main %}
<div class="container text-center">
    <h1 class="my-4">Ca√ßa-N√≠quel</h1>
    <p>Saldo Atual: <strong id="saldo">{{ saldo }}</strong> fichas</p>

    {% if message %}
        <p class="{{ message_class}}" id="message">{{ message }}</p>
    {% endif %}

    <div class="grid-container">
        {% for row in grid %}
            <div class="grid-row">
                {% for symbol in row %}
                    <span class="grid-cell">{{ symbol }}</span>  <!-- Sem a classe "rolling" no in√≠cio -->
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <p id="instrucoes">Clique no bot√£o para jogar!</p>

    <form id="niquel-form" action="/niquel" method="post">
        <button class="btn btn-primary my-4" type="submit" id="play-button">Jogar</button>
    </form>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("niquel-form");
        const button = document.getElementById("play-button");
        const symbols = ["üçí", "üçã", "‚≠ê", "üîî", "üçÄ", "üíé", "üçä"];
        const cells = document.querySelectorAll(".grid-cell");

        form.addEventListener("submit", function (event) {
            event.preventDefault();  // Impede o envio imediato do formul√°rio
            
            let interval = setInterval(() => {
                cells.forEach(cell => {
                    cell.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                });
            }, 100);  // Troca os s√≠mbolos rapidamente

            // Para a anima√ß√£o ap√≥s 2 segundos e envia o formul√°rio
            setTimeout(() => {
                clearInterval(interval);
                form.submit();  // Agora o formul√°rio √© enviado
            }, 2000);
        });
    });
</script>

{% endblock %}